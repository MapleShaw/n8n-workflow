{
  "nodes": [
    {
      "parameters": {
        "formTitle": "PDFè´¢æŠ¥ä¸€é”®ç”Ÿæˆç½‘é¡µ",
        "formDescription": "ç›´æŽ¥ä¸Šä¼ PDFè´¢æŠ¥æ–‡ä»¶ï¼ŒAIå°†åˆ†æžå†…å®¹å¹¶ç”Ÿæˆä¸“ä¸šç½‘é¡µï¼ˆæ”¯æŒPDFç›´æŽ¥å¤„ç†ï¼‰",
        "formFields": {
          "values": [
            {
              "fieldLabel": "ä¸Šä¼ PDFè´¢æŠ¥æ–‡ä»¶",
              "fieldName": "pdfFile",
              "fieldType": "file",
              "requiredField": true,
              "multipleFiles": false,
              "acceptFileTypes": ".pdf"
            },
            {
              "fieldLabel": "é¢å¤–éœ€æ±‚ï¼ˆå¯é€‰ï¼‰",
              "fieldName": "extraRequirements",
              "fieldType": "textarea",
              "fieldPlaceholder": "å¦‚æœ‰ç‰¹æ®Šè¦æ±‚è¯·åœ¨æ­¤è¾“å…¥ï¼Œå¦‚çªå‡ºæŸäº›æ•°æ®ã€ç‰¹å®šçš„å±•ç¤ºé£Žæ ¼ç­‰"
            }
          ]
        },
        "respondWithOptions": {
          "values": {
            "formSubmittedText": "âœ… PDFæ–‡ä»¶å·²ä¸Šä¼ ï¼ŒAIæ­£åœ¨åˆ†æžå¹¶ç”Ÿæˆä¸“ä¸šç½‘é¡µï¼Œè¯·ç¨å€™..."
          }
        }
      },
      "id": "56462ea0-7f6f-47b0-a0fc-64592afc633e",
      "name": "PDFä¸Šä¼ è¡¨å•",
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.1,
      "position": [
        -300,
        -220
      ],
      "webhookId": "pdf-financial-analyzer"
    },
    {
      "parameters": {
        "jsCode": "// å‡†å¤‡PDFæ–‡ä»¶å’Œå®Œæ•´çš„promptï¼Œä¸€æ­¥ç”ŸæˆHTML\nconst formData = $input.first().json;\nconst binaryData = $input.first().binary;\n\nconst extraRequirements = formData.extraRequirements || '';\n\nconsole.log('Form data keys:', Object.keys(formData));\nconsole.log('Binary data available:', !!binaryData);\nconsole.log('Binary data keys:', binaryData ? Object.keys(binaryData) : 'None');\nconsole.log('Extra requirements:', extraRequirements);\n\n// æ£€æŸ¥æ˜¯å¦æœ‰PDFæ–‡ä»¶\nif (!binaryData || Object.keys(binaryData).length === 0) {\n  throw new Error('è¯·ä¸Šä¼ PDFæ–‡ä»¶ï¼');\n}\n\nconst pdfKey = Object.keys(binaryData)[0];\nconst pdfInfo = binaryData[pdfKey];\n\nconsole.log('PDF Info:', {\n  fileName: pdfInfo.fileName,\n  mimeType: pdfInfo.mimeType,\n  dataLength: pdfInfo.data ? pdfInfo.data.length : 0\n});\n\n// æž„é€ å®Œæ•´çš„promptï¼ŒåŒ…å«è´¢æŠ¥åˆ†æžå’ŒHTMLç”Ÿæˆ\nlet completePrompt = `You are an expert financial analyst and web developer. Please analyze the uploaded PDF financial report and create a comprehensive, professional HTML webpage based on the analysis.\n\nðŸ“‹ TASK:\n1. Analyze all financial data in the PDF document\n2. Extract key metrics, trends, and insights\n3. Generate a complete HTML webpage with the analyzed data\n\nðŸŽ¨ DESIGN REQUIREMENTS:\n1. Use Bento Grid visual design style with pure black background and Tencent blue color #006EFF for highlights\n2. Emphasize super large fonts or numbers to highlight key points, create visual contrast between large and small elements\n3. Mix Chinese and English - Chinese in large bold fonts, English as accent text\n4. Simple line graphics for data visualization and decorative elements\n5. Use highlight color transparency gradients for tech feeling, but different highlight colors should not gradient into each other\n6. Mimic Apple website animations, scroll-triggered effects\n7. Data can reference online chart components with consistent styling\n8. Use Framer Motion (via CDN)\n9. Use HTML5, TailwindCSS 3.0+ (via CDN) and necessary JavaScript\n10. Use professional icon libraries like Font Awesome or Material Icons (via CDN)\n11. Avoid using emoji as main icons\n12. Do not omit any content points from the financial analysis\n\nðŸ“Š CONTENT FOCUS:\n- Revenue figures and growth trends\n- Profit margins and financial ratios\n- Business segment performance\n- Strategic initiatives and highlights\n- Comparative data and year-over-year changes\n- Key operational metrics\n- Future outlook and guidance`;\n\n// æ·»åŠ ç”¨æˆ·çš„é¢å¤–éœ€æ±‚\nif (extraRequirements && extraRequirements.trim()) {\n  completePrompt += `\n\nðŸŽ¯ ADDITIONAL USER REQUIREMENTS:\n${extraRequirements}`;\n}\n\ncompletePrompt += `\n\nâš¡ IMPORTANT OUTPUT REQUIREMENTS:\nGenerate MINIFIED HTML code in a single line without line breaks or unnecessary whitespace. The HTML should be production-ready and compressed. Include all CDN links, responsive design, smooth animations, and comprehensive financial data presentation. \n\nRemember: Output ONLY the compressed single-line HTML code ready for production use. Do not include markdown code blocks or explanations.`;\n\nreturn {\n  json: {\n    completePrompt: completePrompt,\n    extraRequirements: extraRequirements,\n    fileName: pdfInfo.fileName,\n    step: 'direct_pdf_to_html'\n  },\n  binary: binaryData\n};"
      },
      "id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
      "name": "Prepare PDF Analysis",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -80,
        -220
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "googlePalmApi",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"contents\": [\n    {\n      \"parts\": [\n        {\n          \"text\": {{ JSON.stringify($json.completePrompt) }}\n        },\n        {\n          \"inline_data\": {\n            \"mime_type\": \"application/pdf\",\n            \"data\": \"{{ Object.values($binary)[0].data }}\"\n          }\n        }\n      ]\n    }\n  ],\n  \"generationConfig\": {\n    \"temperature\": 0.3,\n    \"maxOutputTokens\": 8000,\n    \"topP\": 0.8,\n    \"topK\": 10\n  }\n}",
        "options": {
          "timeout": 120000
        }
      },
      "id": "7fa79fff-bbb5-4ef3-be42-cf33175b54c0",
      "name": "Gemini PDF to HTML",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        180,
        -220
      ],
      "credentials": {
        "googlePalmApi": {
          "id": "mZXaguDyNenhYh5g",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// å¤„ç†Geminiç›´æŽ¥ç”Ÿæˆçš„HTMLç»“æžœ\nconst response = $input.first().json;\nlet generatedHTML = response.candidates[0].content.parts[0].text;\n\n// æ¸…ç†ç”Ÿæˆçš„HTML\ngeneratedHTML = generatedHTML.replace(/```html\\s*/gi, '').replace(/```\\s*$/gi, '');\ngeneratedHTML = generatedHTML.replace(/```\\s*/g, '').replace(/```\\s*$/g, '');\ngeneratedHTML = generatedHTML.trim();\n\n// å¼ºåˆ¶åŽ‹ç¼©HTML\ngeneratedHTML = generatedHTML.replace(/\\r\\n/g, ' ').replace(/\\n/g, ' ').replace(/\\r/g, ' ');\ngeneratedHTML = generatedHTML.replace(/\\t/g, ' ');\ngeneratedHTML = generatedHTML.replace(/\\s+/g, ' ');\ngeneratedHTML = generatedHTML.replace(/> </g, '><');\ngeneratedHTML = generatedHTML.replace(/;\\s+/g, ';').replace(/:\\s+/g, ':').replace(/,\\s+/g, ',');\ngeneratedHTML = generatedHTML.replace(/\\/\\*[^*]*\\*+(?:[^/*][^*]*\\*+)*\\//g, '');\ngeneratedHTML = generatedHTML.trim();\n\n// åˆ›å»ºæ–‡ä»¶å\nconst timestamp = new Date().toISOString().slice(0, 19).replace(/[:.]/g, '-');\nconst originalFileName = $('Prepare PDF Analysis').first().json.fileName || 'financial-report';\nconst cleanFileName = originalFileName.replace(/\\.pdf$/i, '').replace(/[^a-zA-Z0-9-_]/g, '-');\nconst filename = `${cleanFileName}-analysis-${timestamp}.html`;\n\n// åˆ›å»ºä¸‹è½½é“¾æŽ¥\nconst dataUrl = 'data:text/html;charset=utf-8,' + encodeURIComponent(generatedHTML);\n\n// è®¡ç®—åŽ‹ç¼©æ•ˆæžœ\nconst originalSize = response.candidates[0].content.parts[0].text.length;\nconst compressedSize = generatedHTML.length;\nconst compressionRatio = ((originalSize - compressedSize) / originalSize * 100).toFixed(1);\n\nreturn {\n  json: {\n    html: generatedHTML,\n    filename: filename,\n    downloadUrl: dataUrl,\n    status: 'success',\n    message: 'ðŸŽ‰ PDFè´¢æŠ¥åˆ†æžç½‘é¡µç”ŸæˆæˆåŠŸï¼è…¾è®¯è“ä¸»é¢˜+Bento Gridè®¾è®¡',\n    processingInfo: {\n      method: 'Direct PDF to HTML via Gemini 2.0',\n      originalFileName: originalFileName,\n      outputFileName: filename,\n      processingTime: 'Single API call'\n    },\n    compressionInfo: {\n      originalSize: originalSize,\n      compressedSize: compressedSize,\n      compressionRatio: compressionRatio + '%',\n      note: 'å·²ç§»é™¤æ‰€æœ‰æ¢è¡Œç¬¦å’Œå¤šä½™ç©ºç™½'\n    },\n    instructions: {\n      method1: 'ç›´æŽ¥å¤åˆ¶ä¸Šé¢htmlå­—æ®µçš„å†…å®¹ï¼Œç²˜è´´åˆ°.htmlæ–‡ä»¶',\n      method2: 'ç‚¹å‡»downloadUrlé“¾æŽ¥ï¼Œå³é”®ä¿å­˜ç½‘é¡µ',\n      note: 'åŒ…å«PDFåˆ†æž+Framer MotionåŠ¨æ•ˆ+TailwindCSSæ ·å¼+è´¢æŠ¥æ•°æ®å¯è§†åŒ–'\n    },\n    preview: generatedHTML.substring(0, 200) + '...'\n  }\n};"
      },
      "id": "f65cda0f-b68e-4ed7-909a-7c788bfa9e53",
      "name": "Format Output",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        400,
        -220
      ]
    }
  ],
  "connections": {
    "PDFä¸Šä¼ è¡¨å•": {
      "main": [
        [
          {
            "node": "Prepare PDF Analysis",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare PDF Analysis": {
      "main": [
        [
          {
            "node": "Gemini PDF to HTML",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Gemini PDF to HTML": {
      "main": [
        [
          {
            "node": "Format Output",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "9d759523d489cdc6a12d1d955972ae44ecb39da734f80a8e3abdbd12fbacf3eb"
  }
}