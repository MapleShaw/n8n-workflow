{
  "nodes": [
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 1
          },
          "conditions": [
            {
              "id": "edb6de30-d58e-4613-9f0b-0ac21bb21c67",
              "leftValue": "={{ $json[\"ç´ æç±»å‹\"] }}",
              "rightValue": "é“¾æ¥",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "0426e29d-bf13-455c-bd06-c7b26ec49556",
      "name": "åˆ¤æ–­è¾“å…¥ç±»å‹",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        -832,
        -48
      ]
    },
    {
      "parameters": {
        "keepOnlySet": true,
        "values": {
          "string": [
            {
              "name": "sourceMaterial",
              "value": "={{ $json.sourceText }}"
            }
          ]
        },
        "options": {}
      },
      "id": "904976d9-ed54-4669-9b44-66120036d2db",
      "name": "è®¾ç½®è¾“å…¥æ–‡æœ¬ä¸ºç´ æ",
      "type": "n8n-nodes-base.set",
      "typeVersion": 2,
      "position": [
        -464,
        80
      ]
    },
    {
      "parameters": {
        "jsCode": "// è·å–ä¸Šä¸€ä¸ªèŠ‚ç‚¹ä¼ å…¥çš„åŸå§‹æ–‡æœ¬\nlet text = $input.first().json.data.markdown;\n\n// 1. ç§»é™¤æ‰€æœ‰Markdownå›¾ç‰‡æ ‡ç­¾ï¼Œä¾‹å¦‚ ![Image](...)\ntext = text.replace(/\\!\\[.*?\\]\\(.*?\\)/g, '');\n\n// 2. ç§»é™¤æ‰€æœ‰Markdowné“¾æ¥ï¼Œä½†ä¿ç•™é“¾æ¥æ–‡æœ¬ï¼Œä¾‹å¦‚ [link text](URL) -> link text\ntext = text.replace(/\\[(.*?)\\]\\(.*?\\)/g, '$1');\n\n// 3. ç§»é™¤å¾®ä¿¡æ–‡ç« ç‰¹æœ‰çš„å™ªéŸ³å’Œé¡µè„šä¿¡æ¯\nconst noise = [\n  'Original',\n  'é¢„è§ˆæ—¶æ ‡ç­¾ä¸å¯ç‚¹',\n  'å¾®ä¿¡æ‰«ä¸€æ‰«èµèµä½œè€…',\n  'èµèµåå±•ç¤ºæˆ‘çš„å¤´åƒ',\n  'Like the Author',\n  'Other Amount',\n  'æœ€ä½èµèµ',\n  'Comment',\n  'Send Message',\n  'å†™ç•™è¨€:',\n  'Scan to Follow',\n  'ç»§ç»­æ»‘åŠ¨çœ‹ä¸‹ä¸€ä¸ª',\n  'è½»è§¦é˜…è¯»åŸæ–‡',\n  'å‘ä¸Šæ»‘åŠ¨çœ‹ä¸‹ä¸€ä¸ª',\n  'å½“å‰å†…å®¹å¯èƒ½å­˜åœ¨æœªç»å®¡æ ¸çš„ç¬¬ä¸‰æ–¹å•†ä¸šè¥é”€ä¿¡æ¯ï¼Œè¯·ç¡®è®¤æ˜¯å¦ç»§ç»­è®¿é—®ã€‚',\n  'ç»§ç»­è®¿é—®Cancel',\n  'Got It',\n  'å¯åœ¨ã€Œå…¬ä¼—å· > å³ä¸Šè§’ > åˆ’çº¿ã€æ‰¾åˆ°åˆ’çº¿è¿‡çš„å†…å®¹',\n  'é£é™©æç¤º',\n  'OK',\n  'Back',\n  'Close',\n  'æ›´å¤š',\n  'Submit',\n  'è¡¨æƒ…',\n  'å…³é—­',\n  'ç¡®è®¤æäº¤æŠ•è¯‰',\n  'ä½ å¯ä»¥è¡¥å……æŠ•è¯‰åŸå› ï¼ˆé€‰å¡«ï¼‰',\n  'ç¡®å®š',\n  'Name cleared',\n  'No articles',\n  'Articles'\n];\nconst noiseRegex = new RegExp(noise.join('|'), 'g');\ntext = text.replace(noiseRegex, '');\n\n// 4. ç§»é™¤æ‰€æœ‰ç‹¬ç«‹çš„URLé“¾æ¥\ntext = text.replace(/https?:\\/\\/[^\\s]+/g, '');\n\n// 5. ç§»é™¤XML/SVGæ ¼å¼çš„å ä½ç¬¦\ntext = text.replace(/<svg[\\s\\S]*?<\\/svg>/g, '');\n\n// 6. å°†å¤šä¸ªæ¢è¡Œç¬¦åˆå¹¶ä¸ºä¸€ä¸ªï¼Œå¹¶æ¸…ç†å¤šä½™çš„ç©ºæ ¼\ntext = text.replace(/\\n{3,}/g, '\\n\\n'); // æœ€å¤šä¿ç•™ä¸¤ä¸ªæ¢è¡Œç¬¦\ntext = text.replace(/^[\\s\\n]+|[\\s\\n]+$/g, ''); // ç§»é™¤å¼€å¤´å’Œç»“å°¾çš„ç©ºç™½\n\n// è¿”å›æ¸…æ´—åçš„ç»“æœ\nreturn { cleanedText: text };\n"
      },
      "id": "cff0d7ed-ae11-485d-9e8a-f81fbad23e2f",
      "name": "æ¸…æ´—æ–‡æœ¬å†…å®¹",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -352,
        -160
      ]
    },
    {
      "parameters": {
        "formTitle": "è¯·è¾“å…¥æ’­å®¢åŸå§‹ç´ æ",
        "formDescription": "ç›´æ¥ç²˜è´´æ–‡æœ¬ï¼Œæˆ–è€…é“¾æ¥",
        "formFields": {
          "values": [
            {
              "fieldLabel": "ç´ æç±»å‹",
              "fieldType": "dropdown",
              "fieldOptions": {
                "values": [
                  {
                    "option": "æ–‡æœ¬"
                  },
                  {
                    "option": "é“¾æ¥"
                  }
                ]
              }
            },
            {
              "fieldLabel": "ç´ æå†…å®¹",
              "fieldType": "textarea"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.2,
      "position": [
        -1024,
        -48
      ],
      "id": "10ce7051-437d-4468-a75b-d74bb0afb0ff",
      "name": "æä¾›ç´ æ",
      "webhookId": "99a17cf5-0219-4867-9954-bc8319d05563"
    },
    {
      "parameters": {
        "operation": "scrape",
        "url": "={{ $json[\"ç´ æå†…å®¹\"] }}",
        "requestOptions": {}
      },
      "type": "@mendable/n8n-nodes-firecrawl.firecrawl",
      "typeVersion": 1,
      "position": [
        -576,
        -160
      ],
      "id": "dea14dcd-a640-44ec-917a-775591fcb055",
      "name": "çˆ¬å–ç½‘é¡µå†…å®¹",
      "credentials": {
        "firecrawlApi": {
          "id": "wDlUOYsC2NClmYIO",
          "name": "Firecrawl account"
        }
      }
    },
    {
      "parameters": {
        "keepOnlySet": true,
        "values": {
          "string": [
            {
              "name": "prompt",
              "value": "=You are an expert podcast producer for a 5-minute daily AI news podcast called \"MapleTalk | AIè¿›è¡Œæ—¶\". Your role is to transform raw source material into a complete, ready-to-publish podcast episode package.\n\nThe podcast's tone is: conversational, energetic, insightful, and easy for a non-technical audience to understand. Use storytelling, analogies, and emotional cues. Avoid jargon. The script should feel like a friend sharing exciting news, not a news report.\n\nThe user has provided the following source material:\n---\n{{ $json.cleanedText }}\n---\n\nBased on this material, generate a JSON object with the following structure. Do NOT output anything other than the JSON object itself.All output is in Chinese.\n\n{\n  \"titles\": [\n    \"A catchy, dramatic title for the episode.\",\n    \"A second catchy title, perhaps with a question.\",\n    \"A third catchy title, perhaps using numbers or a strong statement.\"\n  ],\n  \"script\": \"A complete, 5-minute conversational podcast script. Start with an energetic greeting. Use storytelling and analogies to explain the core concepts from the source material. The tone should be enthusiastic and insightful. End with a concluding thought and a friendly sign-off.About 1200 chinese words\",\n  \"shownote\": \"A complete shownote for the å°å®‡å®™ platform. It must follow this exact Markdown structure:\\n\\n### å¼•å­\\n\\nA short, enticing introduction summarizing the episode's key takeaway in 3-5 sentences, within 300 chinese words.\n\nğŸµæœ¬æœŸçš„ BGM\nMinimalist Electronic\n\nğŸ“‡å…³äºã€MapleTalk | AIè¿›è¡Œæ—¶ã€‘\nè¿™æ˜¯ä¸€æ¡£è®©ä½ ç”¨â€œåˆ·ç‰™çš„åŠŸå¤«è·Ÿä¸ŠAIæµªæ½®â€çš„å¿«é—ªæ’­å®¢ã€‚\næ¯ä¸ªå·¥ä½œæ—¥æ¸…æ™¨ï¼Œä¸»æ’­ä»¬ä¼šä¸ºä½ å¸¦æ¥5åˆ†é’Ÿçš„â€œAIæ—©é¤ç®€æŠ¥â€ï¼Œç”¨æœ€æœ‰è¶£çš„å¤§ç™½è¯ï¼Œä¸ºä½ ç²¾é€‰å…¨çƒæœ€æ–°ã€æœ€æœ‰æ–™çš„AIåŠ¨æ€ï¼Œè®©ä½ è½»æ¾æˆä¸ºæœ‹å‹åœˆæœ€æ‡‚AIçš„é‚£ä¸ªâ€œå¼„æ½®å„¿â€ã€‚\næ¬¢è¿è®¢é˜…ï¼Œä¸é”™è¿‡æ¯ä¸€æ¬¡çš„AIè¿›åŒ–ç¬é—´ï¼\n\nğŸå…³äºæ’­å®¢ä¸»ç†äºº\nå—¨ï¼Œæˆ‘æ˜¯ MapleShawï¼Œä¸€ä¸ªä¹äºåˆ†äº«çš„ç§‘æŠ€çˆ±å¥½è€…ï¼Œè‡´åŠ›äºç”¨æœ€ç®€å•çš„æ–¹å¼ï¼Œè®©ä½ çœ‹æ‡‚æœ€å‰æ²¿çš„æœªæ¥ã€‚\nä½ ä¹Ÿå¯ä»¥åœ¨è¿™äº›åœ°æ–¹æ‰¾åˆ°æˆ‘ï¼Œæ¬¢è¿æ¥å›´è§‚å’Œäº¤æµï¼š\nX (Twitter): @msjiaozhu\nå°çº¢ä¹¦: MapleShaw\",\n  \"bgmSuggestion\": \"Suggest a specific music style (e.g., 'Uplifting Lofi-Hiphop', 'Minimalist Electronic Beat') and provide a fictional example track name to inspire the user.\"\n}\n"
            }
          ]
        },
        "options": {}
      },
      "id": "c7962b08-9bab-4037-ab13-0e681a23f592",
      "name": "å‡†å¤‡AIæŒ‡ä»¤",
      "type": "n8n-nodes-base.set",
      "typeVersion": 2,
      "position": [
        -112,
        -48
      ]
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash-preview-05-20",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash-preview-05-20"
        },
        "messages": {
          "values": [
            {
              "content": "={{ $json.prompt }}"
            }
          ]
        },
        "jsonOutput": true,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1,
      "position": [
        96,
        -48
      ],
      "id": "68ca6c26-3598-4831-b640-8c609b2a9330",
      "name": "Gemini ç”Ÿæˆå†…å®¹",
      "credentials": {
        "googlePalmApi": {
          "id": "mZXaguDyNenhYh5g",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const contentString = $input.first().json.content.parts[0].text;\nconst parsedContent = JSON.parse(contentString);\n\nreturn parsedContent;"
      },
      "id": "3a0454aa-406f-4bea-9cb4-91dc2f965997",
      "name": "è§£æAIç»“æœ",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        432,
        -48
      ]
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1TlIARTuxosSiQ5QJId9YNwUNermivl3viYjSIAZdf_Q",
          "mode": "list",
          "cachedResultName": "å°å®‡å®™æ’­å®¢å†…å®¹",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1TlIARTuxosSiQ5QJId9YNwUNermivl3viYjSIAZdf_Q/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "å·¥ä½œè¡¨1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1TlIARTuxosSiQ5QJId9YNwUNermivl3viYjSIAZdf_Q/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "title": "=1ï¸âƒ£{{ $json.titles[0] }}\n2ï¸âƒ£{{ $json.titles[1] }}\n3ï¸âƒ£{{ $json.titles[2] }}",
            "script": "={{ $json.script }}",
            "shownote": "={{ $json.shownote }}",
            "bgmSuggestion": "={{ $json.bgmSuggestion }}",
            "date": "={{ $now.format('yyyy-MM-dd') }}",
            "id": "={{ $now.toMillis() }}"
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "title",
              "displayName": "title",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "script",
              "displayName": "script",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "shownote",
              "displayName": "shownote",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "bgmSuggestion",
              "displayName": "bgmSuggestion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "date",
              "displayName": "date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        656,
        -48
      ],
      "id": "ada9e8f1-57dd-4162-9f35-187909e5b73b",
      "name": "æ›´æ–°è‡³ Google è¡¨æ ¼",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "dDXOM5NEA8kutXBF",
          "name": "Google Sheets account"
        }
      }
    }
  ],
  "connections": {
    "åˆ¤æ–­è¾“å…¥ç±»å‹": {
      "main": [
        [
          {
            "node": "çˆ¬å–ç½‘é¡µå†…å®¹",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "è®¾ç½®è¾“å…¥æ–‡æœ¬ä¸ºç´ æ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è®¾ç½®è¾“å…¥æ–‡æœ¬ä¸ºç´ æ": {
      "main": [
        [
          {
            "node": "å‡†å¤‡AIæŒ‡ä»¤",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ¸…æ´—æ–‡æœ¬å†…å®¹": {
      "main": [
        [
          {
            "node": "å‡†å¤‡AIæŒ‡ä»¤",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æä¾›ç´ æ": {
      "main": [
        [
          {
            "node": "åˆ¤æ–­è¾“å…¥ç±»å‹",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "çˆ¬å–ç½‘é¡µå†…å®¹": {
      "main": [
        [
          {
            "node": "æ¸…æ´—æ–‡æœ¬å†…å®¹",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å‡†å¤‡AIæŒ‡ä»¤": {
      "main": [
        [
          {
            "node": "Gemini ç”Ÿæˆå†…å®¹",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Gemini ç”Ÿæˆå†…å®¹": {
      "main": [
        [
          {
            "node": "è§£æAIç»“æœ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è§£æAIç»“æœ": {
      "main": [
        [
          {
            "node": "æ›´æ–°è‡³ Google è¡¨æ ¼",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "9d759523d489cdc6a12d1d955972ae44ecb39da734f80a8e3abdbd12fbacf3eb"
  }
}